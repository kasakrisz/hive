PREHOOK: query: create table t1(a string, b int) clustered by (b) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@t1
POSTHOOK: query: create table t1(a string, b int) clustered by (b) into 2 buckets stored as orc TBLPROPERTIES ('transactional'='true')
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@t1
PREHOOK: query: insert into t1(a, b) values
('in bucket 1', 1),
('move to bucket 1', 2),
('in bucket 1', 1),
('do not move to bucket 1', 2)
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
PREHOOK: Output: default@t1
POSTHOOK: query: insert into t1(a, b) values
('in bucket 1', 1),
('move to bucket 1', 2),
('in bucket 1', 1),
('do not move to bucket 1', 2)
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
POSTHOOK: Output: default@t1
POSTHOOK: Lineage: t1.a SCRIPT []
POSTHOOK: Lineage: t1.b SCRIPT []
PREHOOK: query: select t1.ROW__ID, t1.INPUT__FILE__NAME, * from t1
PREHOOK: type: QUERY
PREHOOK: Input: default@t1
#### A masked pattern was here ####
POSTHOOK: query: select t1.ROW__ID, t1.INPUT__FILE__NAME, * from t1
POSTHOOK: type: QUERY
POSTHOOK: Input: default@t1
#### A masked pattern was here ####
{"writeid":### Masked writeid ###,"bucketid":536870912,"rowid":0}	file:/home/krisz/project/hive/itests/qtest/target/localfs/warehouse/t1/delta_0000001_0000001_0000/bucket_00000_0	move to bucket 1	2
{"writeid":### Masked writeid ###,"bucketid":536870912,"rowid":1}	file:/home/krisz/project/hive/itests/qtest/target/localfs/warehouse/t1/delta_0000001_0000001_0000/bucket_00000_0	do not move to bucket 1	2
{"writeid":### Masked writeid ###,"bucketid":536936448,"rowid":0}	file:/home/krisz/project/hive/itests/qtest/target/localfs/warehouse/t1/delta_0000001_0000001_0000/bucket_00001_0	in bucket 1	1
{"writeid":### Masked writeid ###,"bucketid":536936448,"rowid":1}	file:/home/krisz/project/hive/itests/qtest/target/localfs/warehouse/t1/delta_0000001_0000001_0000/bucket_00001_0	in bucket 1	1
PREHOOK: query: update t1 set b = 1 where a = 'move to bucket 1'
PREHOOK: type: QUERY
PREHOOK: Input: default@t1
PREHOOK: Output: default@t1
PREHOOK: Output: default@t1
POSTHOOK: query: update t1 set b = 1 where a = 'move to bucket 1'
POSTHOOK: type: QUERY
POSTHOOK: Input: default@t1
POSTHOOK: Output: default@t1
POSTHOOK: Output: default@t1
POSTHOOK: Lineage: t1.a SIMPLE []
POSTHOOK: Lineage: t1.b SIMPLE []
PREHOOK: query: select t1.ROW__ID, t1.INPUT__FILE__NAME, * from t1
PREHOOK: type: QUERY
PREHOOK: Input: default@t1
#### A masked pattern was here ####
POSTHOOK: query: select t1.ROW__ID, t1.INPUT__FILE__NAME, * from t1
POSTHOOK: type: QUERY
POSTHOOK: Input: default@t1
#### A masked pattern was here ####
{"writeid":### Masked writeid ###,"bucketid":536870912,"rowid":1}	file:/home/krisz/project/hive/itests/qtest/target/localfs/warehouse/t1/delta_0000001_0000001_0000/bucket_00000_0	do not move to bucket 1	2
{"writeid":### Masked writeid ###,"bucketid":536936448,"rowid":0}	file:/home/krisz/project/hive/itests/qtest/target/localfs/warehouse/t1/delta_0000001_0000001_0000/bucket_00001_0	in bucket 1	1
{"writeid":### Masked writeid ###,"bucketid":536936448,"rowid":1}	file:/home/krisz/project/hive/itests/qtest/target/localfs/warehouse/t1/delta_0000001_0000001_0000/bucket_00001_0	in bucket 1	1
{"writeid":### Masked writeid ###,"bucketid":536936449,"rowid":0}	file:/home/krisz/project/hive/itests/qtest/target/localfs/warehouse/t1/delta_0000002_0000002_0001/bucket_00001_0	move to bucket 1	1
