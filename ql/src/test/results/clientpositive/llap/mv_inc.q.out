PREHOOK: query: create table t1(a int, b varchar(128)) stored as orc TBLPROPERTIES ('transactional'='true')
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@t1
POSTHOOK: query: create table t1(a int, b varchar(128)) stored as orc TBLPROPERTIES ('transactional'='true')
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@t1
PREHOOK: query: insert into t1(a,b) values (1, 'foo'), (2, 'bar')
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
PREHOOK: Output: default@t1
POSTHOOK: query: insert into t1(a,b) values (1, 'foo'), (2, 'bar')
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
POSTHOOK: Output: default@t1
POSTHOOK: Lineage: t1.a SCRIPT []
POSTHOOK: Lineage: t1.b SCRIPT []
PREHOOK: query: delete from t1 where a = 1
PREHOOK: type: QUERY
PREHOOK: Input: default@t1
PREHOOK: Output: default@t1
POSTHOOK: query: delete from t1 where a = 1
POSTHOOK: type: QUERY
POSTHOOK: Input: default@t1
POSTHOOK: Output: default@t1
PREHOOK: query: select t1.ROW__IS__DELETED, t1.ROW__ID, * from t1
PREHOOK: type: QUERY
PREHOOK: Input: default@t1
#### A masked pattern was here ####
POSTHOOK: query: select t1.ROW__IS__DELETED, t1.ROW__ID, * from t1
POSTHOOK: type: QUERY
POSTHOOK: Input: default@t1
#### A masked pattern was here ####
true	{"writeid":1,"bucketid":536870912,"rowid":0}	1	foo
false	{"writeid":1,"bucketid":536870912,"rowid":1}	2	bar
PREHOOK: query: insert into t1(a,b) values (3, 'one'), (4, 'two'), (4, 'three'), (5, 'four')
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
PREHOOK: Output: default@t1
POSTHOOK: query: insert into t1(a,b) values (3, 'one'), (4, 'two'), (4, 'three'), (5, 'four')
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
POSTHOOK: Output: default@t1
POSTHOOK: Lineage: t1.a SCRIPT []
POSTHOOK: Lineage: t1.b SCRIPT []
PREHOOK: query: delete from t1 where a = 4
PREHOOK: type: QUERY
PREHOOK: Input: default@t1
PREHOOK: Output: default@t1
POSTHOOK: query: delete from t1 where a = 4
POSTHOOK: type: QUERY
POSTHOOK: Input: default@t1
POSTHOOK: Output: default@t1
PREHOOK: query: select t1.ROW__IS__DELETED, t1.ROW__ID, * from t1
PREHOOK: type: QUERY
PREHOOK: Input: default@t1
#### A masked pattern was here ####
POSTHOOK: query: select t1.ROW__IS__DELETED, t1.ROW__ID, * from t1
POSTHOOK: type: QUERY
POSTHOOK: Input: default@t1
#### A masked pattern was here ####
true	{"writeid":1,"bucketid":536870912,"rowid":0}	1	foo
false	{"writeid":1,"bucketid":536870912,"rowid":1}	2	bar
false	{"writeid":3,"bucketid":536870912,"rowid":0}	3	one
true	{"writeid":3,"bucketid":536870912,"rowid":1}	4	two
true	{"writeid":3,"bucketid":536870912,"rowid":2}	4	three
false	{"writeid":3,"bucketid":536870912,"rowid":3}	5	four
PREHOOK: query: update t1
set b = 'updated'
where a = 3
PREHOOK: type: QUERY
PREHOOK: Input: default@t1
PREHOOK: Output: default@t1
POSTHOOK: query: update t1
set b = 'updated'
where a = 3
POSTHOOK: type: QUERY
POSTHOOK: Input: default@t1
POSTHOOK: Output: default@t1
PREHOOK: query: select t1.ROW__IS__DELETED, t1.ROW__ID, * from t1
PREHOOK: type: QUERY
PREHOOK: Input: default@t1
#### A masked pattern was here ####
POSTHOOK: query: select t1.ROW__IS__DELETED, t1.ROW__ID, * from t1
POSTHOOK: type: QUERY
POSTHOOK: Input: default@t1
#### A masked pattern was here ####
true	{"writeid":1,"bucketid":536870912,"rowid":0}	1	foo
false	{"writeid":1,"bucketid":536870912,"rowid":1}	2	bar
true	{"writeid":3,"bucketid":536870912,"rowid":0}	3	one
true	{"writeid":3,"bucketid":536870912,"rowid":1}	4	two
true	{"writeid":3,"bucketid":536870912,"rowid":2}	4	three
false	{"writeid":3,"bucketid":536870912,"rowid":3}	5	four
false	{"writeid":5,"bucketid":536870912,"rowid":0}	3	updated
PREHOOK: query: select t1.ROW__IS__DELETED, t1.ROW__ID, * from t1 order by a
PREHOOK: type: QUERY
PREHOOK: Input: default@t1
#### A masked pattern was here ####
POSTHOOK: query: select t1.ROW__IS__DELETED, t1.ROW__ID, * from t1 order by a
POSTHOOK: type: QUERY
POSTHOOK: Input: default@t1
#### A masked pattern was here ####
true	{"writeid":1,"bucketid":536870912,"rowid":0}	1	foo
false	{"writeid":1,"bucketid":536870912,"rowid":1}	2	bar
true	{"writeid":3,"bucketid":536870912,"rowid":0}	3	one
false	{"writeid":5,"bucketid":536870912,"rowid":0}	3	updated
true	{"writeid":3,"bucketid":536870912,"rowid":1}	4	two
true	{"writeid":3,"bucketid":536870912,"rowid":2}	4	three
false	{"writeid":3,"bucketid":536870912,"rowid":3}	5	four
PREHOOK: query: create table t2(a int, c float) stored as orc TBLPROPERTIES ('transactional'='true')
PREHOOK: type: CREATETABLE
PREHOOK: Output: database:default
PREHOOK: Output: default@t2
POSTHOOK: query: create table t2(a int, c float) stored as orc TBLPROPERTIES ('transactional'='true')
POSTHOOK: type: CREATETABLE
POSTHOOK: Output: database:default
POSTHOOK: Output: default@t2
PREHOOK: query: insert into t2(a,c) values (1, 1.0), (2, 2.0)
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
PREHOOK: Output: default@t2
POSTHOOK: query: insert into t2(a,c) values (1, 1.0), (2, 2.0)
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
POSTHOOK: Output: default@t2
POSTHOOK: Lineage: t2.a SCRIPT []
POSTHOOK: Lineage: t2.c SCRIPT []
PREHOOK: query: insert into t2(a,c) values (3, 3.3), (4, 4.4), (4, 4.5), (5, 5.5)
PREHOOK: type: QUERY
PREHOOK: Input: _dummy_database@_dummy_table
PREHOOK: Output: default@t2
POSTHOOK: query: insert into t2(a,c) values (3, 3.3), (4, 4.4), (4, 4.5), (5, 5.5)
POSTHOOK: type: QUERY
POSTHOOK: Input: _dummy_database@_dummy_table
POSTHOOK: Output: default@t2
POSTHOOK: Lineage: t2.a SCRIPT []
POSTHOOK: Lineage: t2.c SCRIPT []
PREHOOK: query: delete from t2 where a = 4
PREHOOK: type: QUERY
PREHOOK: Input: default@t2
PREHOOK: Output: default@t2
POSTHOOK: query: delete from t2 where a = 4
POSTHOOK: type: QUERY
POSTHOOK: Input: default@t2
POSTHOOK: Output: default@t2
PREHOOK: query: select t2.ROW__IS__DELETED, t2.ROW__ID, * from t2
PREHOOK: type: QUERY
PREHOOK: Input: default@t2
#### A masked pattern was here ####
POSTHOOK: query: select t2.ROW__IS__DELETED, t2.ROW__ID, * from t2
POSTHOOK: type: QUERY
POSTHOOK: Input: default@t2
#### A masked pattern was here ####
false	{"writeid":1,"bucketid":536870912,"rowid":0}	1	1.0
false	{"writeid":1,"bucketid":536870912,"rowid":1}	2	2.0
false	{"writeid":2,"bucketid":536870912,"rowid":0}	3	3.3
true	{"writeid":2,"bucketid":536870912,"rowid":1}	4	4.4
true	{"writeid":2,"bucketid":536870912,"rowid":2}	4	4.5
false	{"writeid":2,"bucketid":536870912,"rowid":3}	5	5.5
PREHOOK: query: select t1.ROW__IS__DELETED, t1.ROW__ID, t2.ROW__IS__DELETED, t2.ROW__ID, * from t1
join t2 on t1.a = t2.a
PREHOOK: type: QUERY
PREHOOK: Input: default@t1
PREHOOK: Input: default@t2
#### A masked pattern was here ####
POSTHOOK: query: select t1.ROW__IS__DELETED, t1.ROW__ID, t2.ROW__IS__DELETED, t2.ROW__ID, * from t1
join t2 on t1.a = t2.a
POSTHOOK: type: QUERY
POSTHOOK: Input: default@t1
POSTHOOK: Input: default@t2
#### A masked pattern was here ####
true	{"writeid":1,"bucketid":536870912,"rowid":0}	false	{"writeid":1,"bucketid":536870912,"rowid":0}	1	foo	1	1.0
false	{"writeid":1,"bucketid":536870912,"rowid":1}	false	{"writeid":1,"bucketid":536870912,"rowid":1}	2	bar	2	2.0
true	{"writeid":3,"bucketid":536870912,"rowid":0}	false	{"writeid":2,"bucketid":536870912,"rowid":0}	3	one	3	3.3
false	{"writeid":5,"bucketid":536870912,"rowid":0}	false	{"writeid":2,"bucketid":536870912,"rowid":0}	3	updated	3	3.3
true	{"writeid":3,"bucketid":536870912,"rowid":1}	true	{"writeid":2,"bucketid":536870912,"rowid":1}	4	two	4	4.4
true	{"writeid":3,"bucketid":536870912,"rowid":1}	true	{"writeid":2,"bucketid":536870912,"rowid":2}	4	two	4	4.5
true	{"writeid":3,"bucketid":536870912,"rowid":2}	true	{"writeid":2,"bucketid":536870912,"rowid":1}	4	three	4	4.4
true	{"writeid":3,"bucketid":536870912,"rowid":2}	true	{"writeid":2,"bucketid":536870912,"rowid":2}	4	three	4	4.5
false	{"writeid":3,"bucketid":536870912,"rowid":3}	false	{"writeid":2,"bucketid":536870912,"rowid":3}	5	four	5	5.5
PREHOOK: query: select t1.ROW__IS__DELETED, t1.ROW__ID, t2.ROW__IS__DELETED, t2.ROW__ID, * from t1
join t2 on t1.a = t2.a
where not t1.ROW__IS__DELETED
  and not t2.ROW__IS__DELETED
PREHOOK: type: QUERY
PREHOOK: Input: default@t1
PREHOOK: Input: default@t2
#### A masked pattern was here ####
POSTHOOK: query: select t1.ROW__IS__DELETED, t1.ROW__ID, t2.ROW__IS__DELETED, t2.ROW__ID, * from t1
join t2 on t1.a = t2.a
where not t1.ROW__IS__DELETED
  and not t2.ROW__IS__DELETED
POSTHOOK: type: QUERY
POSTHOOK: Input: default@t1
POSTHOOK: Input: default@t2
#### A masked pattern was here ####
false	{"writeid":1,"bucketid":536870912,"rowid":1}	false	{"writeid":1,"bucketid":536870912,"rowid":1}	2	bar	2	2.0
false	{"writeid":5,"bucketid":536870912,"rowid":0}	false	{"writeid":2,"bucketid":536870912,"rowid":0}	3	updated	3	3.3
false	{"writeid":3,"bucketid":536870912,"rowid":3}	false	{"writeid":2,"bucketid":536870912,"rowid":3}	5	four	5	5.5
